<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, viewport-fit=cover" />
  <title>MR Studio Mobile (Deploy)</title>

  <style>
    :root{
      --bg-primary:#f2f2f7; --bg-secondary:#ffffff;
      --text-primary:#1c1c1e; --text-secondary:#8e8e93;
      --shadow:rgba(0,0,0,.15);
    }
    body.dark-mode{
      --bg-primary:#1c1c1e; --bg-secondary:#2c2c2e;
      --text-primary:#ffffff; --text-secondary:#98989d;
      --shadow:rgba(0,0,0,.5);
    }
    body{
      margin:0; background:var(--bg-primary); overflow:hidden;
      font-family:-apple-system,"SF Pro Text",sans-serif;
      -webkit-user-select:none; user-select:none; touch-action:none;
      color:var(--text-primary);
    }

    /* Overlay inicial */
    #overlay{
      position:absolute; inset:0;
      display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      background:rgba(255,255,255,.95); backdrop-filter:blur(25px);
      z-index:999;
      transition:opacity .35s ease;
    }
    body.dark-mode #overlay{ background:rgba(28,28,30,.95); }
    h1{ margin:0 0 10px 0; font-size:30px; font-weight:900; letter-spacing:-1px; }
    p{ margin:0 0 26px 0; color:var(--text-secondary); font-weight:700; text-align:center; max-width:86%; }

    #theme-selector{ display:flex; gap:12px; margin-bottom:28px; }
    .theme-option{
      padding:12px 18px; border-radius:16px;
      border:2px solid #e5e5ea; background:#fff;
      font-weight:900; cursor:pointer; display:flex; gap:8px; align-items:center;
      transition:.2s;
    }
    body.dark-mode .theme-option{ background:rgba(44,44,46,.9); border-color:rgba(255,255,255,.12); color:#fff; }
    .theme-option.active{ background:#FF9500; border-color:#FF9500; color:#fff; }
    .theme-option:active{ transform:scale(.97); }

    button.start-btn{
      padding:16px 46px; border:none; border-radius:40px;
      background:#FF9500; color:#fff; font-size:18px; font-weight:900;
      box-shadow:0 10px 26px rgba(255,149,0,.35);
      cursor:pointer; transition:.2s;
    }
    button.start-btn:active{ transform:scale(.97); }

    /* Barras superiores */
    #render-bar, #camera-bar{
      position:absolute; left:50%; transform:translateX(-50%);
      display:flex; gap:6px;
      padding:4px; border-radius:14px;
      background:rgba(255,255,255,.9); backdrop-filter:blur(18px);
      box-shadow:0 6px 18px rgba(0,0,0,.08);
      z-index:120; max-width:92%;
      overflow-x:auto; -webkit-overflow-scrolling:touch;
      scrollbar-width:none;
    }
    body.dark-mode #render-bar, body.dark-mode #camera-bar{
      background:rgba(44,44,46,.86);
      box-shadow:0 6px 18px rgba(0,0,0,.30);
    }
    #render-bar{ top:calc(50px + env(safe-area-inset-top)); }
    #camera-bar{ top:calc(108px + env(safe-area-inset-top)); }
    #render-bar::-webkit-scrollbar, #camera-bar::-webkit-scrollbar{ display:none; }

    .render-opt, .cam-opt{
      border:none; background:transparent;
      padding:8px 14px; border-radius:10px;
      font-size:12px; font-weight:900; color:#999; cursor:pointer;
      white-space:nowrap; transition:.2s;
    }
    body.dark-mode .render-opt, body.dark-mode .cam-opt{ color:#b0b0b6; }
    .render-opt.active, .cam-opt.active{
      background:#fff; color:#000; box-shadow:0 3px 10px rgba(0,0,0,.12);
    }
    body.dark-mode .render-opt.active, body.dark-mode .cam-opt.active{
      background:rgba(255,255,255,.10); color:#fff; box-shadow:0 3px 10px rgba(0,0,0,.35);
    }

    .icon-btn{
      width:44px; height:36px; border-radius:10px; border:none;
      background:rgba(235,235,240,.6);
      font-size:18px; font-weight:900; cursor:pointer;
      transition:.2s;
    }
    body.dark-mode .icon-btn{ background:rgba(255,255,255,.12); color:#fff; }
    .icon-btn:active{ transform:scale(.97); }
    .icon-btn[disabled]{ opacity:.35; cursor:default; transform:none; }

    /* Toolbar principal */
    #toolbar-container{
      position:absolute;
      bottom:calc(35px + env(safe-area-inset-bottom));
      left:0; right:0;
      display:flex; justify-content:center;
      pointer-events:none; z-index:140;
    }
    #toolbar{
      pointer-events:auto;
      display:flex; gap:12px; padding:12px 16px;
      background:rgba(255,255,255,.9); backdrop-filter:blur(26px);
      border-radius:28px;
      box-shadow:0 18px 46px rgba(0,0,0,.16);
      max-width:94%;
      overflow-x:auto; -webkit-overflow-scrolling:touch;
      scrollbar-width:none;
      border:1px solid rgba(255,255,255,.45);
    }
    body.dark-mode #toolbar{
      background:rgba(44,44,46,.86);
      border-color:rgba(255,255,255,.12);
      box-shadow:0 18px 46px rgba(0,0,0,.35);
    }
    #toolbar::-webkit-scrollbar{ display:none; }

    .tool-btn{
      width:56px; height:56px; border-radius:18px; border:none;
      background:rgba(235,235,240,.62);
      font-size:26px; font-weight:900;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      cursor:pointer; transition:.2s; color:#1c1c1e; flex-shrink:0;
    }
    body.dark-mode .tool-btn{ background:rgba(255,255,255,.12); color:#fff; }
    .tool-btn.active{ background:#FF9500; color:#fff; box-shadow:0 10px 22px rgba(255,149,0,.24); }
    .tool-btn:active{ transform:scale(.97); }
    .label{ font-size:9px; margin-top:3px; font-weight:900; opacity:.7; }
    .divider{ width:1px; background:rgba(0,0,0,.12); margin:0 4px; }
    body.dark-mode .divider{ background:rgba(255,255,255,.12); }

    /* Subtoolbar (subcomponentes) */
    #subtoolbar-container{
      position:absolute;
      bottom:calc(112px + env(safe-area-inset-bottom));
      left:0; right:0;
      display:flex; justify-content:center;
      pointer-events:none; z-index:150;
    }
    #subtoolbar{
      pointer-events:auto;
      display:none; gap:10px; padding:8px 12px;
      background:rgba(255,255,255,.86); backdrop-filter:blur(22px);
      border-radius:22px;
      box-shadow:0 14px 34px rgba(0,0,0,.14);
      max-width:92%;
      overflow-x:auto; -webkit-overflow-scrolling:touch;
      scrollbar-width:none;
      border:1px solid rgba(255,255,255,.35);
    }
    body.dark-mode #subtoolbar{ background:rgba(44,44,46,.86); border-color:rgba(255,255,255,.12); }
    #subtoolbar.visible{ display:flex; }
    #subtoolbar::-webkit-scrollbar{ display:none; }

    .sub-btn{
      height:38px; padding:0 14px; border-radius:14px; border:none;
      background:rgba(235,235,240,.62);
      font-weight:900; font-size:12px;
      cursor:pointer; display:flex; align-items:center; gap:8px;
      transition:.2s; flex-shrink:0;
    }
    body.dark-mode .sub-btn{ background:rgba(255,255,255,.12); color:#fff; }
    .sub-btn.active{
      background:rgba(0,122,255,.92);
      color:#fff;
      box-shadow:0 12px 26px rgba(0,122,255,.18);
    }
    .sub-btn.explode.active{
      background:rgba(255,59,48,.92);
      box-shadow:0 12px 26px rgba(255,59,48,.16);
    }
    .pill{
      width:18px; height:18px; border-radius:6px;
      background:rgba(0,0,0,.08);
      display:inline-flex; align-items:center; justify-content:center;
      font-size:12px; font-weight:900;
    }
    body.dark-mode .pill{ background:rgba(255,255,255,.10); }

    /* Panel SOLDAR (weld) */
    #weld-panel{
      position:absolute; left:0; width:100%;
      bottom:-160px;
      background:rgba(44,44,46,.96);
      color:#fff; padding:18px 0;
      border-top:3px solid #34C759;
      transition:bottom .28s cubic-bezier(0.4, 0, 0.2, 1);
      display:flex; flex-direction:column; align-items:center;
      box-shadow:0 -10px 40px rgba(0,0,0,0.45);
      z-index:260;
    }
    #weld-panel.visible{ bottom:0; }
    .weld-btns{ display:flex; gap:14px; margin-top:12px; }
    .btn-action{
      padding:10px 22px;
      border:none; border-radius:14px;
      font-weight:900; cursor:pointer;
      font-size:14px;
    }
    .btn-yes{ background:#34C759; color:#fff; }
    .btn-no{ background:#FF3B30; color:#fff; }
  </style>

  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
    }
  }
  </script>
</head>

<body>

  <div id="overlay">
    <h1>MR STUDIO</h1>
    <p>Mobile 3D Touch Modeling ‚Ä¢ Sub-Edici√≥n (Merge/Explode) ‚Ä¢ Weld ‚Ä¢ Undo/Redo</p>

    <div id="theme-selector">
      <div class="theme-option active" id="theme-light">‚òÄÔ∏è <span>Modo Claro</span></div>
      <div class="theme-option" id="theme-dark">üåô <span>Modo Oscuro</span></div>
    </div>

    <button class="start-btn" id="btn-start">Comenzar</button>
  </div>

  <div id="render-bar">
    <button class="render-opt active" data-render="flat">Plano</button>
    <button class="render-opt" data-render="clay">Clay</button>
    <button class="render-opt" data-render="tech">Tech</button>
  </div>

  <div id="camera-bar">
    <button class="icon-btn" id="btn-undo" title="Undo" disabled>‚ü≤</button>
    <button class="icon-btn" id="btn-redo" title="Redo" disabled>‚ü≥</button>

    <button class="cam-opt" data-cam="fitall">Fit All</button>
    <button class="cam-opt" data-cam="iso">Iso</button>
    <button class="cam-opt" data-cam="top">Top</button>
    <button class="cam-opt" data-cam="front">Front</button>
    <button class="cam-opt" data-cam="right">Right</button>
  </div>

  <!-- Subtoolbar -->
  <div id="subtoolbar-container">
    <div id="subtoolbar">
      <button class="sub-btn active" id="sub-verts"><span class="pill">V</span>V√©rtices</button>
      <button class="sub-btn" id="sub-edges"><span class="pill">E</span>Bordes</button>
      <button class="sub-btn" id="sub-faces"><span class="pill">F</span>Caras</button>
      <button class="sub-btn explode" id="sub-explode"><span class="pill">üí•</span>Explode</button>
      <button class="sub-btn" id="sub-clear"><span class="pill">‚úï</span>Limpiar</button>
    </div>
  </div>

  <!-- Main toolbar -->
  <div id="toolbar-container">
    <div id="toolbar">
      <button class="tool-btn" data-spawn="box">üì¶<span class="label">Cubo</span></button>
      <button class="tool-btn" data-spawn="sphere">‚ö™<span class="label">Esfera</span></button>
      <button class="tool-btn" data-spawn="cylinder">ü•´<span class="label">Cil</span></button>
      <button class="tool-btn" data-spawn="cone">üî∫<span class="label">Cono</span></button>
      <button class="tool-btn" data-spawn="torus">üç©<span class="label">Toro</span></button>
      <button class="tool-btn" data-spawn="plane">üü¶<span class="label">Plano</span></button>
      <div class="divider"></div>

      <button class="tool-btn active" id="btn-move" data-mode="translate">‚ÜîÔ∏è<span class="label">Mover</span></button>
      <button class="tool-btn" id="btn-rot" data-mode="rotate">üîÑ<span class="label">Rotar</span></button>
      <button class="tool-btn" id="btn-scale" data-mode="scale">üîç<span class="label">Escala</span></button>
      <button class="tool-btn" id="btn-select" data-mode="select">‚úÖ<span class="label">Selec</span></button>

      <div class="divider"></div>
      <button class="tool-btn" id="btn-delete">üóëÔ∏è<span class="label">Borrar</span></button>
      <button class="tool-btn" id="btn-color">üé≤<span class="label">Color</span></button>
    </div>
  </div>

  <!-- Weld panel -->
  <div id="weld-panel">
    <div style="font-weight:900;">üîó Fusi√≥n Detectada</div>
    <div style="opacity:.85; font-weight:800; font-size:12px; margin-top:6px;">
      ¬øQuieres soldar (snap) esta selecci√≥n al punto cercano?
    </div>
    <div class="weld-btns">
      <button class="btn-action btn-yes" id="btn-weld-yes">SOLDAR</button>
      <button class="btn-action btn-no" id="btn-weld-no">CANCELAR</button>
    </div>
  </div>

  <script type="module" src="./editor-core.js"></script>
</body>
</html>
